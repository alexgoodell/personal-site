(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1439:function(e,t,i){"use strict";var s=i(981);i.n(s).a},1870:function(e,t,i){"use strict";i.r(t);var s=i(3),n=i.n(s),r=i(1),a=i(517),l=i(176),o=i(5),d={name:"EmbedWidget",components:{BaseWidget:a.a},mixins:[l.a],props:{value:r.a.string},data:function(){return{code:"",errors:[],help_article:"202147702-Embed-webpage",icon:"",defaultIcon:"fa-code",isLoading:!1,inputChangeDelay:500}},computed:{layeredContextMenuConfig:function(){var e=this,t={title:this.$t("general")},i=this.getWidgetActionsField();i.items.splice(1,0,{id:"refresh",label:this.$t("refresh"),clickHandler:function(){e.refreshIframe(),e.closeContextSidebar()}});var s=this.getLayeredContextMenuConfig(i);if(this.checkContext(this.contextMenuIds.DISPLAY_ID)){var n=[[{label:this.$t("iframe.type.caption"),type:"oneRowRadio",vmodel:this.widgetData.settings,vmodelField:"t",isWrapped:!0,options:[{id:"web page",value:0,label:this.$t("iframe.type.iframe")},{id:"image",value:1,label:this.$t("iframe.type.image")},{id:"script",value:2,label:this.$t("iframe.type.script")}],inputChangeHandler:this.saveSettings},{label:this.$t("iframe.url"),type:"text",vmodel:this.widgetData.settings,vmodelField:"u",saveOnEnter:!0,inputChangeHandler:this.saveSettings,inputChangeDelay:this.inputChangeDelay},{label:"",type:"toggler",vmodel:this.widgetData.settings,vmodelField:"b",options:{label:this.$t("iframe.borderless"),isDivided:!0},inputChangeHandler:this.saveSettings},{label:"",type:"toggler",vmodel:this.widgetData.settings,vmodelField:"i",options:{label:this.$t("iframe.invert_colors"),isDivided:!0},inputChangeHandler:this.saveSettings},{label:"",type:"toggler",vmodel:this.widgetData.settings,vmodelField:"s",options:{label:this.$t("iframe.suppress_scrollbars"),isDivided:!0},inputChangeHandler:this.saveSettings},{label:this.$t("iframe.height"),type:"number",vmodel:this.widgetData.settings,vmodelField:"h",saveOnEnter:!0,inputChangeHandler:this.saveSettings,inputChangeDelay:this.inputChangeDelay}]];s.push({headerTitle:this.$t("display_settings"),hasArrow:!0,listenHeader:!0,hasClose:!0,headerClickHandler:function(){e.removeContext(e.contextMenuIds.DISPLAY_ID)},tabs:[t],fields:n,activeTab:0})}return s},areScrollbarsSuppressed:function(){return!!this.settings.s&&1===this.settings.s},domain:function(){return this.$urlHelper.getSite(this.src)},hasErrors:function(){return this.errors.length>0},hasSrc:function(){return!!this.src},hasUrl:function(){return!!this.url},height:function(){return this.settings.h},isBorderless:function(){return!!this.settings.b&&1===this.settings.b},isIframe:function(){return 0===this.type},isImage:function(){return 1===this.type},isInverted:function(){return!!this.inverted},inverted:function(){return this.settings.i},isSandboxed:function(){return!this.domain||this.domain!==window.primaryDomain},isScript:function(){return 2===this.type},isUrlSecure:function(){return this.hasUrl&&(this.$urlHelper.isSecure(this.url)||this.$urlHelper.isData(this.url))},scriptTag:function(){return'\n        <html>\n          <head>\n            <style>\n              iframe {\n                display: block;\n                margin: 0 auto;\n              }\n            </style>\n          </head>\n          <body style="margin: 0; padding: 0">\n            <script type="text/javascript" src="'.concat(this.src,'"><\/script>\n          </body>\n        </html>\n      ')},src:function(){return this.url},srcDoc:function(){var e=/^data:text\/html(?:;charset=.+?)?(;base64)?,(.+)$/.exec(this.src);if(!e)return null;var t=decodeURIComponent(e[2]);return e[1]?atob(t):t},type:function(){return this.settings.t},url:function(){return"string"===typeof this.settings.u&&this.settings.u.length?this.settings.u:null},isWidgetsGalleryPreview:function(){return"WidgetsGalleryPreviewPage"===this.$route.name}},watch:{code:function(){this.clearErrors()},isEditingState:function(e){if(e)return this.code=this.src,void this.focusField();this.validate()}},created:function(){this.setGivenContent()},methods:{applyConfiguration:function(e){var t=this,i=e.type,s=e.url,r=e.height,a=e.borderless,l=e.tryImage,d=void 0!==l&&l;if(this.$utils.isPlainObject(o.a)){var c=n()({},this.widgetData.settings,{t:i,u:s});if(void 0!==r&&(c.h=parseInt(r)),void 0!==a&&(c.b=a?1:0),d){var h=new Image;h.onload=function(){t.code===c.u&&(c.t=o.a.embedTypes.image,h.height>0&&(c.h=h.height),t.applySettings(c,!0),t.code="")},h.onerror=function(){t.applySettings(c,!0),t.code=""},h.src=s}else this.applySettings(c,!0),this.code=""}},refreshIframe:function(){try{this.$refs.iframe.src=this.$refs.iframe.src}catch(e){}},settingsDefaults:function(){return{u:null,h:350,t:o.a.embedTypes.iframe,b:0,s:0,p:0,i:0}},applySettings:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEditingState&&this.toggleEditing(this.widgetData.id),this.isLoading&&(this.isLoading=!1),this.widgetData.settings=e,t&&this.saveSettings()},clearErrors:function(){this.errors.length=0},emptyWidgetActionConfig:function(){var e=this;return{icon:this.defaultIcon,label:this.$t("iframe.embed_content"),actionHandler:function(){return e.toggleEditing(e.widgetData.id)}}},focusField:function(){var e=this;this.$nextTick(function(){e.isHeaderFocused||void 0===e.$refs.field||e.$refs.field.focus()})},isEmpty:function(){return!this.hasUrl},reset:function(){this.applySettings(this.settingsDefaults()),this.code=""},validate:function(){if(this.code.length){this.isLoading=!0,this.clearErrors();var e=this.$codeParsers.parseEmbedCode(this.code);if(!e)return this.errors.push(this.$t("iframe.invalid_code")),void(this.isLoading=!1);this.applyConfiguration(e)}},setGivenContent:function(){this.value&&(this.code=this.value)}}},c=(i(1439),i(7)),h=Object(c.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"embed-widget"},[i("BaseWidget",{attrs:{"is-marginless":e.isBorderless}},[i("div",{staticClass:"embed-widget__body"},[!e.hasUrl&&e.widgetData.isWidgetsMarketplace?i("div",{staticClass:"embed-widget__stub",class:{"embed-widget__stub_borderless":e.isWidgetsGalleryPreview}},[e._v(e._s(e.$t("widgets_marketplace.enter_url")))]):e.isEditingState?[i("transition",{attrs:{name:"embed-widget__fade"}},[e.hasErrors?i("div",{staticClass:"embed-widget__errors"},e._l(e.errors,function(t,s){return i("span",{key:s,staticClass:"embed-widget__error"},[i("i",{staticClass:"embed-widget__icon fa fa-times-circle"}),e._v(" "),i("span",{staticClass:"embed-widget__text"},[e._v(e._s(t))])])}),0):e._e()]),e._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.code,expression:"code",modifiers:{trim:!0}}],ref:"field",staticClass:"embed-widget__area",attrs:{autofocus:"",name:"code",placeholder:e.$t("iframe.paste_here")},domProps:{value:e.code},on:{paste:function(e){e.stopPropagation()},input:function(t){t.target.composing||(e.code=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]:e._e(),e._v(" "),e.isEditingState||e.isRefreshing||!e.hasSrc?e._e():i("div",{staticClass:"embed-widget__content",class:{"embed-widget__content_inverted":e.isInverted}},[e.isIframe?i("iframe",{ref:"iframe",staticClass:"embed-widget__iframe",attrs:{allowfullscreen:"",frameborder:"0",mozallowfullscreen:"",seamless:"",webkitallowfullscreen:"",height:e.height,sandbox:e.isSandboxed?"allow-forms allow-scripts allow-popups allow-same-origin":null,scrolling:e.areScrollbarsSuppressed?"no":null,src:e.src,srcdoc:e.srcDoc}}):e.isImage?i("img",{staticClass:"embed-widget__image",style:{maxHeight:e.height+"px"},attrs:{src:e.src}}):e.isScript?i("iframe",{staticClass:"embed-widget__iframe",attrs:{allowfullscreen:"",frameborder:"0",mozallowfullscreen:"",sandbox:"allow-forms allow-scripts allow-popups allow-same-origin",seamless:"",src:"data:text/html;charset=utf-8,"+e.scriptTag,webkitallowfullscreen:"",height:e.height,scrolling:e.areScrollbarsSuppressed?"no":null}}):e._e()])],2)])],1)},[],!1,null,null,null);t.default=h.exports},981:function(e,t,i){}}]);