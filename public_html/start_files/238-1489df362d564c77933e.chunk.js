(window.webpackJsonp=window.webpackJsonp||[]).push([[238],{1015:function(t,e,s){},1478:function(t,e,s){"use strict";var i=s(1015);s.n(i).a},1879:function(t,e,s){"use strict";s.r(e);var i=s(68),n=s.n(i),o=s(517),a=s(176),c=s(810),r=s(4),l=s(23),u={name:"StockQuotesWidget",components:{BaseWidget:o.a,draggable:n.a,AutocompleteList:c.a,SvgStrokeIcon:l.a},mixins:[a.a],data:function(){return{input:"",icon:"",defaultIcon:"fa-money",help_article:"200154592-Stock-Quotes",refreshInterval:null,newStockQuoteInput:"",isFormBlurred:!1,isInputSelected:!1,isLoading:!1,stockQuotes:{},unsupportedStockSymbols:["^DJA","^DJC","^DJI","^DJT","^DJU"],preview:{title_phrase:"new_finance_widget_title",f:[{s:"GOOG",n:"GOOG - Alphabet Inc. (NASDAQ)"},{s:"AMZN",n:"AMZN - Amazon.com, Inc. (NASDAQ)"},{s:"MSFT",n:"MSFT - Microsoft Corporation (NASDAQ)"}]}}},computed:{stocks:function(){return this.widgetData.isPreviewMode?this.preview.f:this.settings.f&&this.settings.f.length>0?this.settings.f:[]},hideNames:function(){return this.widgetData&&this.widgetData.settings&&this.widgetData.settings.o},layeredContextMenuConfig:function(){var t=this,e={title:this.$t("general")},s=this.getWidgetActionsField();if(this.isEditingState)s.items=s.items.filter(function(t){return"edit"!==t.id});else{var i=s.items.find(function(t){return"edit"===t.id});i&&(i.label=this.$t("edit_symbols"))}s.items.splice(1,0,{id:"refresh",label:this.$t("refresh"),clickHandler:function(){t.refresh(),t.closeContextSidebar()}}),s.items.unshift({id:"add_symbol",label:this.$t("add_symbol"),clickHandler:function(){t.toggleEditing(t.widgetData.id),t.closeContextSidebar()}});var n=this.getLayeredContextMenuConfig(s);if(this.checkContext(this.contextMenuIds.DISPLAY_ID)){var o=[[{label:this.$t("settings"),type:"toggler",vmodel:this.widgetData.settings,vmodelField:"o",value:this.widgetData.settings.o,options:{label:this.$t("show_stock_symbols_only")},inputChangeHandler:function(){t.saveSettings()}}]];n.push({headerTitle:this.$t("display_settings"),hasArrow:!0,listenHeader:!0,hasClose:!0,headerClickHandler:function(){t.removeContext(t.contextMenuIds.DISPLAY_ID)},tabs:[e],fields:o,activeTab:0})}return n}},watch:{isEditingState:function(t){t&&this.$nextTick(this.activateInput)}},mounted:function(){this.fetchStockQuotes(),this.initAutoRefresh()},beforeDestroy:function(){clearInterval(this.refreshInterval)},methods:{settingsDefaults:function(){return{f:this.widgetData.isPreviewMode?this.preview.f:[]}},isEmpty:function(){return 0===this.stocks.length},emptyWidgetActionConfig:function(){var t=this;return{icon:"fa-line-chart",label:this.$t("add_symbol"),actionHandler:function(){return t.toggleEditing()}}},refresh:function(){this.fetchStockQuotes()},initAutoRefresh:function(){this.refreshInterval=setInterval(this.refresh,9e5)},toggleStockContextMenu:function(t,e){var s=this;if(!t.shiftKey&&!t.ctrlKey&&(1!==this.stocks.length||this.stocks[0].n)){var i=[{id:"delete",name:this.$t("delete"),icon:"fa fa-trash-o",clickHandler:function(){return s.deleteQuote(e)}}];this.$eventBus.$emit("toggle-contextmenu",{items:i,positionX:t.pageX,positionY:t.pageY,event:t})}},activateInput:function(){this.newStockQuoteInput="",this.isFormBlurred=!1,this.isInputSelected=!0},blurForm:function(){this.isFormBlurred=!0,this.isInputSelected=!1},fetchSuggestions:function(t){var e=this;return r.b.fetchStockTickerSuggestions(t).then(function(t){var s=[];return t&&t.data&&t.data.forEach(function(t){if(!(e.unsupportedStockSymbols.indexOf(t.symbol)>=0)){var i=t.exchange?" ("+t.exchange+")":"";s.push({name:"".concat(t.symbol," - ").concat(t.name).concat(i),value:t.symbol,icon:"fa-line-chart"})}}),s}).catch(function(t){return[]})},fetchStockQuotes:function(){var t=this;this.isLoading=!0;var e=this.stocks.map(function(t){return t.s});e&&0!==e.length?r.b.fetchStockTickerData(e).then(function(e){t.stockQuotes=e,t.$forceUpdate(),t.isLoading=!1}).catch(function(){t.isLoading=!1}):this.isLoading=!1},addQuote:function(t){var e=this,s={n:t.name,s:t.value};this.settings.f||(this.settings.f=[]),this.settings.f.push(s),this.saveSettings().then(function(){e.refresh()}),this.newStockQuoteInput=""},deleteQuote:function(t){this.settings.f=this.settings.f.filter(function(e){return e.s!==t.s}),this.saveSettings()},removeDraggedStatus:function(){var t=this;this.saveSettings(),this.$nextTick(function(){t.isDragged=!1})},setDraggedStatus:function(){var t=this;this.$nextTick(function(){t.isDragged=!0})},linkToYahooFinance:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s="Yahoo Finance",i="https://finance.yahoo.com/",n="";if(t){n=t.n,i+="q?s=".concat(t.s),s=this.hideNames?t.s:t.n;var o=this.getStockData(t.s);o&&(n="".concat(t.s," - ").concat(o.name," (").concat(o.exchange,")"))}return'<a class="'.concat(e?"stock-quotes-widget__link":"stock-quotes-widget__item",'" href="').concat(i,'" target="_blank" title="').concat(n,'">').concat(s,"</a>")},getStockData:function(t){return this.stockQuotes[t]},lastPrice:function(t){return this.getStockData(t)?this.formatNumber(this.getStockData(t).price):"-"},previousPrice:function(t){return this.getStockData(t)?this.formatNumber(this.getStockData(t).previousPrice):"-"},priceChange:function(t){return this.getStockData(t)?this.formatNumber(this.getStockData(t).change):"-"},priceChangePct:function(t){return this.getStockData(t)?this.formatNumber(this.getStockData(t).change/(this.getStockData(t).previousPrice||this.getStockData(t).preMarketPrice)*100):"-"},formatNumber:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=Object.assign({},{minimumFractionDigits:e,maximumFractionDigits:s},i);return this.$n(t,n)},timeLastChanged:function(t){if(this.getStockData(t))return this.getStockData(t).time},priceRange:function(t){if(this.getStockData(t))return this.getStockData(t).range},advancedTabFormField:function(){return{label:this.$t("settings"),type:"toggler",vmodel:this.widgetData.settings,vmodelField:"o",value:this.widgetData.settings.o,options:{label:this.$t("show_stock_symbols_only")},inputChangeHandler:function(){}}}}},d=(s(1478),s(7)),h=Object(d.a)(u,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stock-quotes-widget"},[s("BaseWidget",{attrs:{"is-marginless":t.isEditingState}},[t.isEditingState?t._e():s("div",{staticClass:"stocks-list"},[s("div",{staticClass:"stocks-list__header"},[s("div",{staticClass:"header-row"},[s("div",{staticClass:"header-row__cell"},[t._v("Symbol")]),t._v(" "),s("div",{staticClass:"header-row__last-price"},[t._v("Last")]),t._v(" "),s("div",{staticClass:"header-row__prev-price"},[t._v("Previous")]),t._v(" "),s("div",{staticClass:"header-row__price-change"},[t._v("Change (%)")])])]),t._v(" "),s("tbody",{staticClass:"stocks-list__body"},t._l(t.stocks,function(e,i){return s("div",{key:i,staticClass:"stock-row stock-row_table",on:{contextmenu:function(s){return t.toggleStockContextMenu(s,e)}}},[s("div",{staticClass:"stock-row__stock-quote",domProps:{innerHTML:t._s(t.linkToYahooFinance(e))}}),t._v(" "),s("div",{staticClass:"stock-row__last-price",attrs:{title:t.timeLastChanged(e.s)}},[t._v(t._s(t.lastPrice(e.s)))]),t._v(" "),s("div",{staticClass:"stock-row__prev-price"},[t._v(t._s(t.previousPrice(e.s)))]),t._v(" "),s("div",{class:["stock-row__price-change",{down:!!t.getStockData(e.s)&&t.getStockData(e.s).down}],attrs:{title:t.priceRange(e.s)}},[t._v("\n            "+t._s(t.priceChange(e.s))+"\n            "),t.getStockData(e.s)?[t._v("\n              \xa0("+t._s(t.priceChangePct(e.s))+"%)\n              "),s("SvgStrokeIcon",{staticClass:"stock-row__feather-icon",attrs:{icon:"arrow-up"}})]:t._e()],2)])}),0)]),t._v(" "),t.isEditingState?s("draggable",t._b({staticClass:"stocks-list editing",attrs:{tag:"ul"},on:{start:t.setDraggedStatus,end:t.removeDraggedStatus},model:{value:t.settings.f,callback:function(e){t.$set(t.settings,"f",e)},expression:"settings.f"}},"draggable",{group:"stocks-list",handle:".stock-row",ghostClass:"stock-row_is-ghost",chosenClass:"stock-row_is-chosen",fallbackClass:"stock-row_is-dragged",forceFallback:!0,fallbackTolerance:3,disabled:!t.isEditingState},!1),t._l(t.stocks,function(e,i){return s("li",{key:i,staticClass:"stock-row",attrs:{title:e.n||e.s},on:{contextmenu:function(s){return t.toggleStockContextMenu(s,e)}}},[s("a",{staticClass:"stock-row__wrapper",attrs:{target:"_blank",href:"https://finance.yahoo.com/q?s="+e.s}},[t.isEditingState?s("i",{staticClass:"stock-row__icon fa fa-line-chart"}):t._e(),t._v(" "),s("span",{staticClass:"stock-row__name"},[t._v(t._s(e.n))]),t._v(" "),t.isEditingState?s("span",{staticClass:"stock-row__action-buttons"},[s("span",{attrs:{title:t.$t("delete")},on:{click:function(s){return s.preventDefault(),s.stopPropagation(),t.deleteQuote(e)}}},[s("i",{staticClass:"fa fa-trash"})])]):t._e()])])}),0):t._e(),t._v(" "),t.isEditingState?s("AutocompleteList",{staticClass:"stock-quotes-widget__inline-add-form",attrs:{value:t.newStockQuoteInput,"suggestions-fetcher":t.fetchSuggestions,"option-chosen-handler":t.addQuote,"is-blurred":t.isFormBlurred,"is-selected":t.isInputSelected,"activate-label":t.$t("new_symbol"),"input-placeholder":t.$t("new_symbol_description")},model:{value:t.newStockQuoteInput,callback:function(e){t.newStockQuoteInput=e},expression:"newStockQuoteInput"}}):t._e(),t._v(" "),t.isEditingState?t._e():s("div",{staticClass:"stock-quotes-widget__footer"},[s("span",{staticClass:"stock-quotes-widget__text stock-quotes-widget__text_small",domProps:{innerHTML:t._s(t.$t("widgets.by",{name:t.linkToYahooFinance(null,!0)}))}})])],1)],1)},[],!1,null,null,null);e.default=h.exports},738:function(t,e,s){},791:function(t,e,s){"use strict";var i=s(738);s.n(i).a},810:function(t,e,s){"use strict";var i=s(1),n=s(45),o=s.n(n),a=s(23),c=void 0,r={name:"AutocompleteList",components:{SvgStrokeIcon:a.a},props:{value:i.a.string,suggestionsFetcher:i.a.func.isRequired,optionChosenHandler:i.a.func.isRequired,isBlurred:i.a.bool.def(!1),isSelected:i.a.bool.def(!1),activateLabel:i.a.string.isRequired,inputPlaceholder:i.a.string.isRequired},data:function(){return{selectedIndex:0,suggestions:[],inputValue:this.value,isInputSelected:this.isSelected,isFormBlurred:this.isBlurred}},watch:{isSelected:function(t){t&&(this.isInputSelected=t)},isInputSelected:function(t){t&&this.selectAndFocusInput()},isBlurred:function(t){c.isFormBlurred=t},value:function(t){this.inputValue=t},inputValue:o()(function(t){var e=this;t?this.suggestionsFetcher(t).then(function(t){e.suggestions=t}).catch(function(t){e.$logger.log(t),e.clearSuggestions()}):this.clearSuggestions()},500)},created:function(){this.$eventBus.$on("keypress-escape",this.clearSuggestions)},beforeDestroy:function(){this.$eventBus.$off("keypress-escape",this.clearSuggestions)},mounted:function(){this.isInputSelected&&this.selectAndFocusInput()},methods:{activateInput:function(){this.isInputSelected=!0,this.isFormBlurred=!1},deactivateInput:function(){this.isInputSelected=!1,this.isFormBlurred=!0,this.clearSuggestions()},clearSuggestions:function(){this.suggestions=[],this.selectedIndex=0},clearInput:function(){this.inputValue=""},selectAndFocusInput:function(){this.$refs.input.focus(),this.$refs.input.select()},changeSelected:function(t){this.setSelectedIndex(this.selectedIndex+(parseInt(t)||0));var e=this.$el.querySelector(".autocomplete-list__select > li:nth-child(".concat(this.selectedIndex+1,")"));e&&e.scrollIntoView(!1)},handleOptionChosen:function(){this.suggestions[this.selectedIndex]&&(this.optionChosenHandler(this.suggestions[this.selectedIndex]),this.clearSuggestions(),this.clearInput())},setSelectedIndex:function(t){t<0?this.selectedIndex=this.suggestions.length-1:t>=this.suggestions.length?this.selectedIndex=0:this.selectedIndex=t}}},l=(s(791),s(7)),u=Object(l.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"autocomplete-list"},[s("div",{staticClass:"autocomplete-list__form",class:{"autocomplete-list__form_blurred":t.isFormBlurred}},[s("div",{staticClass:"autocomplete-list__wrapper"},[s("div",{staticClass:"autocomplete-list__inputbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],ref:"input",staticClass:"autocomplete-list__input",attrs:{type:"text",placeholder:t.inputPlaceholder},domProps:{value:t.inputValue},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),t.handleOptionChosen(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.changeSelected(1)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.changeSelected(-1)}],focus:t.activateInput,blur:t.deactivateInput,click:function(t){t.stopPropagation()},paste:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"autocomplete-list__buttons"},[s("div",{staticClass:"autocomplete-list__buttons-wrapper"},[t.inputValue.length?s("a",{staticClass:"autocomplete-list__button",attrs:{title:t.$t("clear")},on:{click:function(e){return e.stopPropagation(),t.clearInput(e)}}},[s("SvgStrokeIcon",{staticClass:"autocomplete-list__feather-icon",attrs:{icon:"x",options:{size:16}}})],1):t._e(),t._v(" "),s("a",{staticClass:"autocomplete-list__button",attrs:{title:t.$t("add")},on:{click:function(e){return e.stopPropagation(),t.handleOptionChosen(e)}}},[s("SvgStrokeIcon",{staticClass:"autocomplete-list__feather-icon",attrs:{icon:"plus",options:{size:16}}})],1)])])])]),t._v(" "),t.suggestions.length>0&&!t.isFormBlurred?s("div",{staticClass:"autocomplete-list__hidden"},[s("ul",{staticClass:"autocomplete-list__select"},t._l(t.suggestions,function(e,i){return s("li",{key:i,staticClass:"autocomplete-list__selectable",class:{"autocomplete-list__selectable_selected":i===t.selectedIndex},on:{mousedown:t.handleOptionChosen,mouseenter:function(e){return t.setSelectedIndex(i)}}},[e.icon?s("i",{staticClass:"autocomplete-list__icon fa",class:e.icon}):t._e(),t._v(" "),s("span",{staticClass:"autocomplete-list__title"},[t._v(t._s(e.name))])])}),0)]):t._e()])},[],!1,null,null,null);e.a=u.exports}}]);