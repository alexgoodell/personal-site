(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1442:function(t,e,i){"use strict";var n=i(984);i.n(n).a},175:function(t,e,i){},1873:function(t,e,i){"use strict";i.r(e);var n=i(1),s=i(517),a=i(705),o=i(176),r=i(731),l={auto:0,small:1,medium:2,large:3},c={name:"NotesWidget",components:{BaseWidget:s.a,SidebarButton:a.a},mixins:[o.a],props:{value:n.a.string},data:function(){return{intervalId:null,notes:"",initialNotes:"",icon:"",defaultIcon:"fa-sticky-note",help_article:"201208671-Notes",defaultBackgroundColor:{r:255,g:255,b:221},preview:{title_phrase:"new_notes_widget_title",t:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras ut vulputate libero. Proin bibendum luctus velit at luctus. Suspendisse malesuada."},caretPosition:null,mdFactory:null}},computed:{processedText:function(){if(!this.notes&&!this.widgetData.isPreviewMode)return"";var t=this.widgetData.isPreviewMode?this.preview.t:this.notes,e=this.mdFactory.markdown()(t,{sanitize:!1,smartypants:!0,breaks:!0,paragraphTag:"<p>"});return this.mdFactory.DOMPurify.sanitize(e)},height:function(){var t={1:7,2:15,3:30};return t[this.settings.s||0]?21*t[this.settings.s]:null},inIframe:function(){try{return window.self!==window.top}catch(t){return!0}},layeredContextMenuConfig:function(){var t=this,e={title:this.$t("general")},i=this.getWidgetActionsField(),n=i.items.find(function(t){return"edit"===t.id});n&&(n.label=this.$t("edit_notes")),this.isEditingState&&this.$utils.hasAccessToClipboard()&&i.items.splice(1,0,{id:"paste",label:this.$t("paste"),clickHandler:function(){t.pasteNote(),t.closeContextSidebar()}});var s=this.getLayeredContextMenuConfig(i);if(this.checkContext(this.contextMenuIds.DISPLAY_ID)){var a=Object.entries(l).map(function(e){var i="size.".concat(e[0]);return"auto"===e[0]&&(i="auto"),{id:e[0],value:e[1],label:t.$t(i)}}),o=[[{label:this.$t("height"),type:"oneRowRadio",vmodel:this.settings,vmodelField:"s",options:a,inputChangeHandler:function(){t.saveSettings()}}]];s.push({headerTitle:this.$t("display_settings"),hasArrow:!0,listenHeader:!0,hasClose:!0,headerClickHandler:function(){t.removeContext(t.contextMenuIds.DISPLAY_ID)},tabs:[e],fields:o,activeTab:0})}return s}},watch:{"settings.t":{handler:function(){this.setGivenNote()}},"settings.s":{handler:function(t){var e=this;this.isEditingState&&this.$nextTick(function(){return e.$refs.textarea.$el.focus()})}},isEditingState:function(t){var e=this;t&&this.$nextTick(function(){return e.$refs.textarea.$el.focus()})}},created:function(){this.setGivenNote(),this.$eventBus.$on("keypress-escape",this.saveAndClose),this.mdFactory=new r.a},mounted:function(){this.addListener()},beforeDestroy:function(){this.$eventBus.$off("keypress-escape",this.saveAndClose),this.removeListener()},methods:{saveChanges:function(){this.processNoteSaving()},beforeSaveHook:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.settings.t=this.notes)},settingsDefaults:function(){return{s:0}},addListener:function(){var t=this.$refs.container;t&&t.addEventListener("click",this.checkLink)},removeListener:function(){var t=this.$refs.container;t&&t.removeEventListener("click",this.checkLink)},checkLink:function(t){if(this.inIframe)try{var e=t.target.href;this.$urlHelper.isValid(e)&&(t.preventDefault(),this.$urlHelper.openUrl(e,t,!0))}catch(i){}},leaveEditMode:function(){this.isEditingState&&this.toggleEditing(this.widgetData.id)},processNoteSaving:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.settings.t!==this.notes&&(this.settings.t||this.notes)&&(this.settings.t=this.notes,this.saveSettings(this.widgetData,t))},setGivenNote:function(){return this.widgetData&&this.widgetData.settings&&this.widgetData.settings.t?(this.notes=this.widgetData.settings.t,void(this.initialNotes=this.widgetData.settings.t)):this.value?(this.notes=this.value,void(this.initialNotes=this.value)):(this.notes="",void(this.initialNotes=""))},isEmpty:function(){return!1},pasteNote:function(){var t=this;this.$utils.readFromClipboard().then(function(e){if(null!==t.caretPosition){var i=t.caretPosition,n=i.start,s=i.end;t.notes="".concat(t.notes.substring(0,n)).concat(e).concat(t.notes.substring(s)),t.caretPosition=null,t.$forceUpdate()}else t.notes="".concat(t.notes).concat(e)}).catch(this.$logger.log)},saveCaretPosition:function(){this.caretPosition=this.getCaretPosition()},getCaretPosition:function(){if(!this.$refs.textarea)return null;var t=this.$refs.textarea.$el;if(document.selection){var e=document.selection.createRange(),i=e.text.length;e.moveStart("character",-t.value.length);var n=e.text.length-i;return{start:n,end:n+i}}return t.selectionStart||0===t.selectionStart?{start:t.selectionStart,end:t.selectionEnd}:{start:0,end:0}},closeWithoutSaving:function(){this.notes=this.initialNotes,this.leaveEditMode()},saveAndClose:function(){this.leaveEditMode(),this.processNoteSaving()},enableEditingState:function(){this.isEditable&&(this.isEditingState=!0)},setEditingStateActive:function(){this.isEditable&&this.toggleEditing(this.widgetData.id,{skipHeaderSelection:!0})}}},d=(i(1442),i(7)),u=Object(d.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"notes-widget-wrapper"},[i("BaseWidget",{attrs:{"is-marginless":""}},[!t.isEditable||!t.isEditingState&&t.notes.length?i("div",{staticClass:"notes-widget",class:["height-"+(t.settings.s||0),{"notes-widget_theme_dark":t.isDark}]},[i("span",{ref:"container",staticClass:"notes-widget__result",domProps:{innerHTML:t._s(t.processedText)},on:{dblclick:function(e){return e.stopPropagation(),e.preventDefault(),t.setEditingStateActive(e)}}})]):[i("textarea-autosize",{ref:"textarea",staticClass:"notes-widget__textarea",class:{"notes-widget__textarea_empty":!t.isEditingState&&!t.notes.length,"notes-widget__textarea_reduced":t.isEditingState&&!t.notes.length},style:t.backgroundColor.a<1?{}:{backgroundColor:"rgb("+t.backgroundColor.r+", "+t.backgroundColor.g+", "+t.backgroundColor.b+")"},attrs:{"min-height":30,"max-height":t.height},on:{paste:function(t){t.stopPropagation()}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?t.saveAndClose(e):null},dblclick:function(t){t.stopPropagation(),t.preventDefault()},paste:function(t){t.stopPropagation()},mouseout:function(e){return t.saveCaretPosition(e)},mouseup:function(e){return t.saveCaretPosition(e)},click:function(e){return e.stopPropagation(),t.enableEditingState(e)}},model:{value:t.notes,callback:function(e){t.notes=e},expression:"notes"}}),t._v(" "),t.notes.length?t._e():i("div",{staticClass:"notes-widget__placeholder"},[t._v(t._s(t.$t("start_writing")))])],t._v(" "),t.isEditingState?i("div",{staticClass:"notes-widget__controls"},[i("div",{staticClass:"notes-widget__buttons"},[i("a",{staticClass:"notes-widget__button notes-widget__button_default",on:{click:function(e){return e.stopPropagation(),t.saveAndClose(e)}}},[t._v(t._s(t.$t("save")))]),t._v(" "),i("a",{staticClass:"notes-widget__button",on:{click:function(e){return e.stopPropagation(),t.closeWithoutSaving(e)}}},[t._v(t._s(t.$t("cancel")))])])]):t._e()],2)],1)},[],!1,null,null,null);e.default=u.exports},516:function(t,e,i){"use strict";var n={name:"ThreeDotsSpinner",props:{isBlue:i(1).a.bool.def(!1)}},s=(i(556),i(7)),a=Object(s.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:["three-dots-spinner",{"three-dots-spinner_color_blue":this.isBlue}]},[e("span",{staticClass:"three-dots-spinner__element"})])},[],!1,null,null,null);e.a=a.exports},556:function(t,e,i){"use strict";var n=i(175);i.n(n).a},703:function(t,e,i){},705:function(t,e,i){"use strict";var n=i(1),s={name:"SidebarButton",components:{ThreeDotsSpinner:i(516).a},props:{caption:n.a.string.isRequired.def(""),popup:n.a.string,icon:n.a.string.def(""),textIcon:n.a.string.def(""),href:n.a.string.def(""),hasPlus:n.a.bool.def(!1),isInline:n.a.bool.def(!1),isGreen:n.a.bool.def(!1),isGradientGreen:n.a.bool.def(!1),isDefault:n.a.bool.def(!1),isWarning:n.a.bool.def(!1),isLink:n.a.bool.def(!1),isDisabled:n.a.bool.def(!1),isShrinked:n.a.bool.def(!1),isLightened:n.a.bool.def(!1),isLoading:n.a.bool.def(!1),isSmall:n.a.bool.def(!1),isTiny:n.a.bool.def(!1),hasInlineIcon:n.a.bool.def(!1),movedLeft:n.a.bool.def(!1),isIncreased:n.a.bool.def(!1),target:n.a.oneOf(["_blank","_self","_top"]).def("_self")}},a=(i(706),i(7)),o=Object(a.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"sidebar-button",class:{"sidebar-button_color_green":t.isGreen,"sidebar-button_color_gradient-green":t.isGradientGreen,"sidebar-button_default":t.isDefault,"sidebar-button_warning":t.isWarning,"sidebar-button_link":t.isLink,"sidebar-button_disabled":t.isDisabled,"sidebar-button_shrinked":t.isShrinked,"sidebar-button_lightened":t.isLightened,"sidebar-button_blocked":t.isLoading,"sidebar-button_inline":t.isInline,"sidebar-button_small":t.isSmall,"sidebar-button_tiny":t.isTiny,"sidebar-button_moved_left":t.movedLeft,"sidebar-button_increased":t.isIncreased},attrs:{href:t.href.length>0?t.href:"javascript:;",target:t.target,title:t.popup}},[t.isLoading?i("span",{staticClass:"sidebar-button__spinner"},[i("ThreeDotsSpinner")],1):i("span",{staticClass:"sidebar-button__caption"},[t.hasPlus||t.textIcon?[t.hasPlus?i("span",{staticClass:"sidebar-button__plus"},[t._v("+")]):i("i",{class:["sidebar-button__texticon fa",t.textIcon]}),t._v("\xa0\n      "),i("span",{staticClass:"sidebar-button__text"},[t._v(t._s(t.caption))])]:[t._v(t._s(t.caption))],t._v(" "),t.icon&&t.hasInlineIcon?i("i",{class:["sidebar-button__icon sidebar-button__icon_inline fa",t.icon]}):t._e()],2),t._v(" "),t.icon&&!t.hasInlineIcon?i("i",{class:["sidebar-button__icon fa",t.icon]}):t._e()])},[],!1,null,null,null);e.a=o.exports},706:function(t,e,i){"use strict";var n=i(703);i.n(n).a},731:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var n=i(63),s=i.n(n),a=i(71),o=i.n(a),r=i(776),l=i.n(r),c=i(777),d=i.n(c),u=function(){function t(){s()(this,t),this.DOMPurify=d.a}return o()(t,[{key:"markdown",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,i=new l.a.Renderer;t&&(i.link=function(t,e,i){var n;if(l.a.options.sanitize){try{n=decodeURIComponent(unescape(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(a){return""}if(0===n.indexOf("javascript:"))return""}var s='<a href="'+t+'"';return e&&(s+=' title="'+e+'"'),s+=' rel="nofollow">'+i+"</a>"});var n=Object.assign({},{renderer:i},e);return l.a.setOptions(n),l.a}}]),t}()},984:function(t,e,i){}}]);